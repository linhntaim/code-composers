"use strict";function _typeof(obj){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.PugComposer=exports.EOL_MAC=exports.EOL_UNIX=exports.EOL_WINDOWS=exports.SPACE_TAB=exports.SPACE_2=exports.SPACE_4=void 0;var _composer=require("../composer");var _parse=_interopRequireDefault(require("parse5"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var SPACE_4="    ";exports.SPACE_4=SPACE_4;var SPACE_2="  ";exports.SPACE_2=SPACE_2;var SPACE_TAB="\t";exports.SPACE_TAB=SPACE_TAB;var EOL_WINDOWS="\r\n";exports.EOL_WINDOWS=EOL_WINDOWS;var EOL_UNIX="\n";exports.EOL_UNIX=EOL_UNIX;var EOL_MAC="\r";exports.EOL_MAC=EOL_MAC;var PugComposer=/*#__PURE__*/function(_Composer){_inherits(PugComposer,_Composer);var _super=_createSuper(PugComposer);function PugComposer(){var _this;var space=arguments.length>0&&arguments[0]!==undefined?arguments[0]:SPACE_4;var eol=arguments.length>1&&arguments[1]!==undefined?arguments[1]:EOL_WINDOWS;_classCallCheck(this,PugComposer);_this=_super.call(this);_this.space=space;_this.eol=eol;_this.lines=[];return _this}_createClass(PugComposer,[{key:"compose",value:function compose(content){this.lines=[];this.traverseNode(_parse["default"].parse(content));return this.lines.join(this.eol)}},{key:"traverseNode",value:function traverseNode(node){var level=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var previousNode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var nextNode=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;switch(node.nodeName){case"#document":case"#document-fragment":this.traverseChildNodes(node,level-1);break;case"#documentType":this.printDocumentTypeNode(node,level);break;case"#text":this.printTextNode(node,level,previousNode,nextNode);break;case"#comment":this.printCommentNode(node,level);break;default:this.printTagNode(node,level).traverseChildNodes(node,level);}return this}},{key:"traverseChildNodes",value:function traverseChildNodes(node,level){var _this2=this;node.childNodes.forEach(function(childNode,index){return _this2.traverseNode(childNode,level+1,index?node.childNodes[index-1]:null,index<node.childNodes.length-1?node.childNodes[index+1]:null)});return this}},{key:"printDocumentTypeNode",value:function printDocumentTypeNode(node,level){this.lines.push(this.printDocumentTypeLine(node,level));return this}},{key:"printDocumentTypeLine",value:function printDocumentTypeLine(node,level){return this.printSpace(level)+this.printDocumentType(node)}},{key:"printDocumentType",value:function printDocumentType(node){return["doctype",node.name,node.publicId?"PUBLIC":"",node.publicId,node.systemId].filter(function(item){return!!item.trim()}).join(" ")}},{key:"printTextNode",value:function printTextNode(node,level){var _this3=this;var previousNode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var nextNode=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(node.value.trim()===""&&(previousNode&&"tagName"in previousNode&&nextNode&&"tagName"in nextNode||previousNode&&"tagName"in previousNode&&!nextNode||!previousNode&&nextNode&&"tagName"in nextNode)){return this}this.printTextNodeLine(node,level,!previousNode||!("tagName"in previousNode),!nextNode||!("tagName"in nextNode)).forEach(function(line){return _this3.lines.push(line)});return this}},{key:"printCommentNode",value:function printCommentNode(node,level){var _this4=this;this.printCommentNodeLine(node,level).forEach(function(line){return _this4.lines.push(line)});return this}},{key:"printTagNode",value:function printTagNode(node,level){this.lines.push(this.printTagNodeLine(node,level));return this}},{key:"printTextNodeLine",value:function printTextNodeLine(node,level){var _this5=this;var trimSpaceLeft=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var trimSpaceRight=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;return this.printText(node,trimSpaceLeft,trimSpaceRight).map(function(text){return _this5.printSpace(level)+text})}},{key:"printCommentNodeLine",value:function printCommentNodeLine(node,level){var _this6=this;return this.printComment(node).map(function(text){return _this6.printSpace(level)+text})}},{key:"printTagNodeLine",value:function printTagNodeLine(node,level){return this.printSpace(level)+this.printTag(node)}},{key:"printSpace",value:function printSpace(level){return this.space.repeat(level)}},{key:"printText",value:function printText(node){var trimSpaceLeft=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var trimSpaceRight=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;return function(text){if(trimSpaceLeft&&trimSpaceRight){text=text.trim()}else if(trimSpaceLeft){text=text.replace(/^\s+/,"")}else if(trimSpaceRight){text=text.replace(/\s+$/,"")}return text}(node.value).split(/\r*\n|\r/).map(function(text){return"| "+text})}},{key:"printComment",value:function printComment(node){return node.value.trim().split(/\r*\n|\r/).map(function(comment){return"// "+comment.trim()})}},{key:"printTag",value:function printTag(node){var _this7=this;var name=node.tagName;var id="";var classes=[];var attributes=[];node.attrs.forEach(function(attribute){switch(attribute.name){case"id":id="#"+attribute.value.trim();break;case"class":(function(classesString){if(classesString!==""){classes.push.apply(classes,_toConsumableArray(classesString.split(/\s+/)))}})(attribute.value.trim());break;default:attributes.push(_this7.printAttribute(attribute));break;}});if(name==="div"&&(id||classes.length)){name=""}return[name,id,classes.length?"."+classes.join("."):"",attributes.length?"("+attributes.join(" ")+")":""].join("")}},{key:"printAttribute",value:function printAttribute(attribute){return attribute.name+"=\""+attribute.value+"\""}},{key:"composedFileExtension",value:function composedFileExtension(){return"pug"}}]);return PugComposer}(_composer.Composer);exports.PugComposer=PugComposer;
//# sourceMappingURL=pug-composer.js.map